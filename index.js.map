{"version":3,"file":"index.js","sources":["../src/js/router.js","../src/js/sidebar.js","../src/js/header.js","../src/js/utils.js","../src/js/posts.js","../src/js/myposts.js","../src/js/comments.js"],"sourcesContent":["// src/js/router.js\n\n/**\n * .view —Ö–æ–≤–∞—î–º–æ,\n * container/main –∑–∞–ª–∏—à–∞—î–º–æ view--active.\n */\nexport function showView(name) {\n  document.querySelectorAll('.view').forEach(v => {\n    v.classList.toggle('view--active', v.id === `view-${name}`);\n  });\n}","// src/js/sidebar.js\nimport { showView } from './router.js';\n\ndocument.addEventListener('DOMContentLoaded', () => {\n  const navItems = document.querySelectorAll('.sidebar__nav-item[data-view]');\n  navItems.forEach(item => {\n    const view = item.dataset.view;\n    item.addEventListener('click', e => {\n      e.preventDefault();\n\n      // –°–∫–∏–¥–∞—î–º–æ active –∑ —É—Å—ñ—Ö –ø—É–Ω–∫—Ç—ñ–≤\n      navItems.forEach(i => i.classList.remove('sidebar__nav-item--active'));\n      item.classList.add('sidebar__nav-item--active');\n      showView(view);\n    });\n  });\n\n  // ‚Äî DISPLAY USERNAME ‚Äî\n  const userNameSpan = document.querySelector('.sidebar__user-name');\n  const sessionUser = JSON.parse(localStorage.getItem('sessionUser') || 'null');\n  userNameSpan.textContent = sessionUser?.username || 'Guest';\n\n  // ‚Äî USER MENU ‚Äî\n  const userBlock = document.querySelector('.sidebar__user');\n  const toggleBtn = userBlock.querySelector('.sidebar__user-toggle');\n  const menu = userBlock.querySelector('.sidebar__user-menu');\n  const logoutBtn = menu.querySelector('.sidebar__user-logout');\n\n  if (!sessionUser) {\n    logoutBtn.style.display = 'none';\n  }\n\n  // –õ–æ–≥—ñ–∫–∞ Log Out\n  logoutBtn.addEventListener('click', e => {\n    e.preventDefault();\n    localStorage.removeItem('sessionUser');\n    window.location.reload();\n  });\n\n  // –í—ñ–¥–∫—Ä–∏—Ç—Ç—è/–∑–∞–∫—Ä–∏—Ç—Ç—è –º–µ–Ω—é\n  toggleBtn.addEventListener('click', e => {\n    e.stopPropagation();\n    menu.classList.toggle('visible');\n  });\n  document.addEventListener('click', () => {\n    menu.classList.remove('visible');\n  });\n  menu.addEventListener('click', e => e.stopPropagation());\n\n  showView('home');\n});\n","// src/js/header.js\nimport { showView } from './router.js';\n\ndocument.addEventListener('DOMContentLoaded', () => {\n  const tabs = document.querySelectorAll('.header__tab');\n\n  tabs.forEach(tab => {\n    tab.addEventListener('click', e => {\n      e.preventDefault();\n      const view = tab.dataset.view;\n\n      tabs.forEach(t => t.classList.remove('header__tab--active'));\n      tab.classList.add('header__tab--active');\n\n      showView(view);\n    });\n  });\n\n  const initial = document.querySelector('.header__tab--active');\n  if (initial) showView(initial.dataset.view);\n});","// src/js/utils.js\n\n/**\n * –í—ñ–¥–Ω–æ—Å–Ω–∏–π —á–∞—Å –≤—ñ–¥ ISO.  \n */\nexport function relativeTime(iso) {\n  const diff = Date.now() - new Date(iso).getTime();\n  const sec  = Math.floor(diff / 1000);\n  if (sec < 60) return `${sec}s ago`;\n  const min = Math.floor(sec / 60);\n  if (min < 60) return `${min}m ago`;\n  const hrs = Math.floor(min / 60);\n  if (hrs < 24) return `${hrs}h ago`;\n  const days = Math.floor(hrs / 24);\n  return `${days}d ago`;\n}\n\n/**\n * HTML-–µ–∫—Ä–∞–Ω—É–≤–∞–Ω–Ω—è, —É–Ω–∏–∫–∞–Ω–Ω—è XSS.\n */\nexport function escapeHtml(str) {\n  return String(str)\n    .replace(/&/g, '&amp;')\n    .replace(/</g, '&lt;')\n    .replace(/>/g, '&gt;')\n    .replace(/\"/g, '&quot;')\n    .replace(/'/g, '&#39;');\n}","// src/js/posts.js\nimport { escapeHtml, relativeTime } from './utils.js';\n\ndocument.addEventListener('DOMContentLoaded', () => {\n  loadPosts();\n});\n\nexport async function loadPosts() {\n  const list = document.getElementById('posts-list');\n  if (!list) return;\n  list.innerHTML = '';\n  try {\n    const res = await fetch('/api/posts?view=all');\n    const posts = await res.json();\n    posts.forEach(post => list.append(createPostElement(post)));\n  } catch (err) {\n    console.error(err);\n    list.innerHTML = '<p>–ù–µ –≤–¥–∞–ª–æ—Å—è –∑–∞–≤–∞–Ω—Ç–∞–∂–∏—Ç–∏ –ø–æ—Å—Ç–∏.</p>';\n  }\n}\n\nfunction createPostElement(post) {\n  const article = document.createElement('article');\n  article.className = 'post-card';\n  article.dataset.postId = post.id;\n\n  article.innerHTML = `\n    <div class=\"post-card__media\">\n      ${post.image_url ? `<img src=\"${post.image_url}\" alt=\"\">` : ''}\n    </div>\n    <div class=\"post-card__body\">\n      <h2 class=\"post-card__title\">${escapeHtml(post.title)}</h2>\n      <p class=\"post-card__info\">\n        ${relativeTime(post.created_at)} by ${escapeHtml(post.username)}\n      </p>\n      ${post.body ? `<p class=\"post-card__text\">${escapeHtml(post.body)}</p>` : ''}\n    </div>\n    <div class=\"post-card__footer\">\n      <div class=\"post-card__votes\">\n        <button class=\"post-card__vote-up\">‚ñ≤</button>\n        <span class=\"post-card__vote-diff\">${post.vote_diff ?? 0}</span>\n        <button class=\"post-card__vote-down\">‚ñº</button>\n      </div>\n      <button class=\"post-card__comments\">üí¨ ${post.comment_count ?? 0}</button>\n    </div>\n  `;\n\n  const upBtn   = article.querySelector('.post-card__vote-up');\n  const downBtn = article.querySelector('.post-card__vote-down');\n  const diffEl  = article.querySelector('.post-card__vote-diff');\n\n  upBtn.addEventListener('click', () => votePost(post.id,  1, upBtn, downBtn, diffEl));\n  downBtn.addEventListener('click', () => votePost(post.id, -1, downBtn, upBtn, diffEl));\n\n  return article;\n}\n\nasync function votePost(postId, vote, thisBtn, otherBtn, diffEl) {\n  const sessionUser = JSON.parse(localStorage.getItem('sessionUser') || 'null');\n  if (!sessionUser) {\n    return alert('–£–≤—ñ–π–¥—ñ—Ç—å, –±—É–¥—å –ª–∞—Å–∫–∞.');\n  }\n\n  try {\n    const res = await fetch(`/api/posts/${postId}/vote`, {\n      method: 'POST',\n      headers: { 'Content-Type': 'application/json' },\n      body: JSON.stringify({ user_id: sessionUser.id, vote })\n    });\n    // —î–¥–∏–Ω–∏–π –≤–∏–∫–ª–∏–∫ res.json()\n    const data = await res.json();\n    if (!res.ok) {\n      throw new Error(data.error || 'Failed to vote');\n    }\n\n    // —è–∫—â–æ –±–µ–∫–µ–Ω–¥ –ø–æ–≤–µ—Ä–Ω—É–≤ vote_diff, –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î–º–æ –π–æ–≥–æ,\n    // —ñ–Ω–∞–∫—à–µ —Ä–æ–±–∏–º–æ local-fallback (old + vote)\n    let newDiff;\n    if (typeof data.vote_diff === 'number') {\n      newDiff = data.vote_diff;\n    } else {\n      const old = parseInt(diffEl.textContent) || 0;\n      // —è–∫—â–æ –º–∏ –≤–∂–µ –±—É–ª–∏ ¬´active¬ª, —Ç–æ —Ç—Ä–µ–±–∞ –≤—ñ–¥–Ω—è—Ç–∏ —Å–∞–º–µ —Ü–µ–π –≥–æ–ª–æ—Å\n      newDiff = thisBtn.classList.contains('active') ? old - vote : old + vote;\n    }\n\n    diffEl.textContent = newDiff;\n\n    if (thisBtn.classList.contains('active')) {\n      thisBtn.classList.remove('active');\n    } else {\n      thisBtn.classList.add('active');\n      otherBtn.classList.remove('active');\n    }\n  } catch (err) {\n    console.error(err);\n    alert(err.message);\n  }\n}","// src/js/myposts.js\nimport { showView } from './router.js';\n\ndocument.addEventListener('DOMContentLoaded', () => {\n  const form = document.getElementById('create-post-form');\n  const list = document.getElementById('myposts-list');\n\n  loadMyPosts();\n\n  // Handle form submission\n  form.addEventListener('submit', async e => {\n    e.preventDefault();\n\n    // Ensure user is signed in\n    const sessionUser = JSON.parse(localStorage.getItem('sessionUser') || 'null');\n    if (!sessionUser) {\n      return alert('–ë—É–¥—å –ª–∞—Å–∫–∞, —É–≤—ñ–π–¥—ñ—Ç—å, —â–æ–± —Å—Ç–≤–æ—Ä—é–≤–∞—Ç–∏ –ø–æ—Å—Ç–∏.');\n    }\n\n    // Collect form data and add user_id\n    const data = Object.fromEntries(new FormData(form));\n    data.user_id = sessionUser.id;\n\n    try {\n      const res = await fetch('/api/posts', {\n        method: 'POST',\n        headers: { 'Content-Type': 'application/json' },\n        body: JSON.stringify(data)\n      });\n      const post = await res.json();\n      if (!res.ok) throw new Error(post.error || '–ù–µ –≤–¥–∞–ª–æ—Å—è —Å—Ç–≤–æ—Ä–∏—Ç–∏ –ø–æ—Å—Ç');\n\n      // Render the new post at the top of my posts\n      const card = createPostElement(post);\n      list.prepend(card);\n\n      form.reset();\n\n      // Also add it to Home view if that container exists\n      const homeContainer = document.querySelector('#view-home .posts');\n      if (homeContainer) {\n        homeContainer.prepend(createPostElement(post));\n      }\n\n      // Switch to My Posts view\n      document\n        .querySelectorAll('.sidebar__nav-item')\n        .forEach(i =>\n          i.classList.toggle('sidebar__nav-item--active', i.dataset.view === 'myposts')\n        );\n      showView('myposts');\n    } catch (err) {\n      alert(err.message);\n    }\n  });\n});\n\nasync function loadMyPosts() {\n  const list = document.getElementById('myposts-list');\n  list.innerHTML = '';\n\n  const sessionUser = JSON.parse(localStorage.getItem('sessionUser') || 'null');\n  if (!sessionUser) {\n    list.innerHTML = '<p>–ë—É–¥—å –ª–∞—Å–∫–∞, —É–≤—ñ–π–¥—ñ—Ç—å, —â–æ–± –ø–æ–±–∞—á–∏—Ç–∏ —Å–≤–æ—ó –ø–æ—Å—Ç–∏.</p>';\n    return;\n  }\n\n  try {\n    const res = await fetch(\n      `/api/posts?view=user&user_id=${encodeURIComponent(sessionUser.id)}`\n    );\n    const posts = await res.json();\n    posts.forEach(post => {\n      list.append(createPostElement(post));\n    });\n  } catch (err) {\n    console.error('Failed to load my posts:', err);\n    list.innerHTML = '<p>–ù–µ –≤–¥–∞–ª–æ—Å—è –∑–∞–≤–∞–Ω—Ç–∞–∂–∏—Ç–∏ –≤–∞—à—ñ –ø–æ—Å—Ç–∏.</p>';\n  }\n}\n\nfunction createPostElement(post) {\n  const article = document.createElement('article');\n  article.className = 'post-card';\n  article.dataset.postId = post.id;\n\n  article.innerHTML = `\n    <div class=\"post-card__media\">\n      ${post.image_url ? `<img src=\"${post.image_url}\" alt=\"\">` : ''}\n    </div>\n    <div class=\"post-card__body\">\n      <h2 class=\"post-card__title\">${escapeHtml(post.title)}</h2>\n      <p class=\"post-card__info\">\n        ${relativeTime(post.created_at)} by ${escapeHtml(post.username)}\n      </p>\n      ${post.body ? `<p class=\"post-card__text\">${escapeHtml(post.body)}</p>` : ''}\n    </div>\n    <div class=\"post-card__footer\">\n      <div class=\"post-card__votes\">\n        <button class=\"post-card__vote-up\">‚ñ≤</button>\n        <span class=\"post-card__vote-diff\">${post.vote_diff ?? 0}</span>\n        <button class=\"post-card__vote-down\">‚ñº</button>\n      </div>\n      <button class=\"post-card__comments\">üí¨ ${post.comment_count ?? 0}</button>\n    </div>\n  `;\n  return article;\n}\n\nfunction relativeTime(iso) {\n  const diff = Date.now() - new Date(iso).getTime();\n  const sec = Math.floor(diff / 1000);\n  if (sec < 60) return `${sec}s ago`;\n  const min = Math.floor(sec / 60);\n  if (min < 60) return `${min}m ago`;\n  const hrs = Math.floor(min / 60);\n  if (hrs < 24) return `${hrs}h ago`;\n  const days = Math.floor(hrs / 24);\n  return `${days}d ago`;\n}\n\nfunction escapeHtml(str) {\n  return str\n    .replace(/&/g, '&amp;')\n    .replace(/</g, '&lt;')\n    .replace(/>/g, '&gt;')\n    .replace(/\"/g, '&quot;')\n    .replace(/'/g, '&#39;');\n}\n","// src/js/comments.js\nimport { escapeHtml, relativeTime } from './utils.js';\n\ndocument.addEventListener('DOMContentLoaded', () => {\n  // –ö–ª—ñ–∫ –ø–æ –∫–Ω–æ–ø—Ü—ñ ‚ÄúComments‚Äù —É –±—É–¥—å-—è–∫–æ–º—É –ø–æ—Å—Ç—ñ\n  document.body.addEventListener('click', async e => {\n    if (!e.target.matches('.post-card__comments')) return;\n    e.preventDefault();\n\n    const postCard = e.target.closest('.post-card');\n    const postId   = postCard.dataset.postId;\n    let commentsEl = postCard.querySelector('.comments');\n\n    // –Ø–∫—â–æ —Å–µ–∫—Ü—ñ—è –≤–∂–µ –≤—ñ–¥–∫—Ä–∏—Ç–∞ ‚Äî –∑–∞–∫—Ä–∏–≤–∞—î–º–æ —Ç—É–º–±–æ—á–∫—É\n    if (commentsEl) {\n      commentsEl.remove();\n      return;\n    }\n\n    // –Ü–Ω–∞–∫—à–µ ‚Äî —Å—Ç–≤–æ—Ä—é—î–º–æ –Ω–æ–≤—É —Å–µ–∫—Ü—ñ—é —Ç–∞ –ø—ñ–¥–≤–∞–Ω—Ç–∞–∂—É—î–º–æ –∫–æ–º–µ–Ω—Ç–∏\n    commentsEl = document.createElement('section');\n    commentsEl.className = 'comments';\n    commentsEl.innerHTML = `\n      <h3 class=\"comments__title\">Comments</h3>\n      <ul class=\"comments__list\"></ul>\n      <form class=\"comments__form\">\n        <textarea\n          class=\"comments__textarea\"\n          placeholder=\"Add a comment‚Ä¶\"\n          rows=\"3\"\n          required\n        ></textarea>\n        <button type=\"submit\" class=\"comments__submit\">Comment</button>\n      </form>\n    `;\n    postCard.append(commentsEl);\n\n    const listEl = commentsEl.querySelector('.comments__list');\n    const formEl = commentsEl.querySelector('.comments__form');\n\n    await loadComments(postId, listEl);\n    attachFormHandler(postId, formEl, listEl);\n  });\n});\n\n// –ó–∞–≤–∞–Ω—Ç–∞–∂—É—î–º–æ —ñ —Ä–µ–Ω–¥–µ—Ä–∏–º–æ –≤—Å—ñ –∫–æ–º–µ–Ω—Ç–∞—Ä—ñ –¥–ª—è postId\nasync function loadComments(postId, listEl) {\n  listEl.innerHTML = '';\n  try {\n    const res = await fetch(`/api/comments?post_id=${postId}`);\n    const comments = await res.json();\n    const tree = buildTree(comments);\n    renderTree(tree, listEl);\n  } catch (err) {\n    console.error('loadComments error:', err);\n  }\n}\n\n// –ë—É–¥—É—î–º–æ –¥–µ—Ä–µ–≤–æ –∫–æ–º–µ–Ω—Ç–∞—Ä—ñ–≤ –∑–∞ parent_id\nfunction buildTree(comments) {\n  const map = {};\n  comments.forEach(c => { c.children = []; map[c.id] = c; });\n  const roots = [];\n  comments.forEach(c => {\n    if (c.parent_id && map[c.parent_id]) {\n      map[c.parent_id].children.push(c);\n    } else {\n      roots.push(c);\n    }\n  });\n  return roots;\n}\n\n// –†–µ–Ω–¥–µ—Ä–∏–º–æ –∫–æ–º–µ–Ω—Ç–∞—Ä—ñ —É <ul>\nfunction renderTree(nodes, container, nested = false) {\n  nodes.forEach(c => {\n    const li = document.createElement('li');\n    li.className = 'comment' + (nested ? ' comment--nested' : '');\n    li.dataset.commentId = c.id;\n    li.innerHTML = `\n      <div class=\"comment__votes\">\n        <button class=\"comment__vote-up\">‚ñ≤</button>\n        <span class=\"comment__vote-diff\">${c.upvotes - c.downvotes}</span>\n        <button class=\"comment__vote-down\">‚ñº</button>\n      </div>\n      <div class=\"comment__content\">\n        <div class=\"comment__info\">\n          ${escapeHtml(c.username)} ‚Ä¢ ${relativeTime(c.created_at)}\n        </div>\n        <p class=\"comment__body\">${escapeHtml(c.body)}</p>\n        <div class=\"comment__actions\">\n          <button class=\"comment__reply\">Reply</button>\n        </div>\n      </div>\n    `;\n    container.append(li);\n\n    if (c.children.length) {\n      renderTree(c.children, container, true);\n    }\n\n    attachCommentHandlers(li, c.id, container);\n  });\n}\n\n// ‚ÄúAdd a comment‚Ä¶‚Äù\nfunction attachFormHandler(postId, formEl, listEl) {\n  formEl.addEventListener('submit', async e => {\n    e.preventDefault();\n    const body = formEl.querySelector('textarea').value.trim();\n    if (!body) return;\n\n    const user = JSON.parse(localStorage.getItem('sessionUser') || 'null');\n    if (!user) {\n      alert('Please sign in to comment');\n      return;\n    }\n\n    try {\n      const res = await fetch('/api/comments', {\n        method: 'POST',\n        headers: { 'Content-Type': 'application/json' },\n        body: JSON.stringify({\n          post_id:   postId,\n          parent_id: null,\n          user_id:   user.id,\n          body\n        })\n      });\n      const newComment = await res.json();\n      if (!res.ok) throw new Error(newComment.error || 'Cannot post comment');\n\n      formEl.reset();\n      await loadComments(postId, listEl);\n    } catch (err) {\n      console.error(err);\n      alert(err.message);\n    }\n  });\n}\n\n// –ü—Ä–∏–∫—Ä—ñ–ø–∫–∞ –≥–æ–ª–æ—Å—É–≤–∞–Ω–Ω—è —Ç–∞ Reply –¥–ª—è –∫–æ–∂–Ω–æ–≥–æ —á–µ–ª–∞\nfunction attachCommentHandlers(liEl, commentId, listEl) {\n  const upBtn    = liEl.querySelector('.comment__vote-up');\n  const downBtn  = liEl.querySelector('.comment__vote-down');\n  const replyBtn = liEl.querySelector('.comment__reply');\n  const postId   = liEl.closest('.post-card').dataset.postId;\n\n  upBtn.addEventListener('click', () => voteComment(commentId,  1, postId, listEl));\n  downBtn.addEventListener('click', () => voteComment(commentId, -1, postId, listEl));\n\n  replyBtn.addEventListener('click', () => {\n    if (liEl.querySelector('.comments__form')) return;\n\n    const replyForm = document.createElement('form');\n    replyForm.className = 'comments__form';\n    replyForm.innerHTML = `\n      <textarea class=\"comments__textarea\" rows=\"2\" required></textarea>\n      <button type=\"submit\" class=\"comments__submit\">Reply</button>\n    `;\n    liEl.append(replyForm);\n\n    replyForm.addEventListener('submit', async e => {\n      e.preventDefault();\n      const body = replyForm.querySelector('textarea').value.trim();\n      const user = JSON.parse(localStorage.getItem('sessionUser') || 'null');\n      if (!user) {\n        alert('Please sign in to reply');\n        return;\n      }\n      try {\n        const res = await fetch('/api/comments', {\n          method: 'POST',\n          headers: { 'Content-Type': 'application/json' },\n          body: JSON.stringify({\n            post_id:   postId,\n            parent_id: commentId,\n            user_id:   user.id,\n            body\n          })\n        });\n        const created = await res.json();\n        if (!res.ok) throw new Error(created.error || 'Cannot reply');\n        await loadComments(postId, listEl);\n      } catch (err) {\n        console.error(err);\n        alert(err.message);\n      }\n    });\n  });\n}\n\n// –ì–æ–ª–æ—Å—É–≤–∞–ª–∫–∞ –∑–∞ –∫–æ–º–µ–Ω—Ç–∞—Ä\nasync function voteComment(commentId, vote, postId, listEl) {\n  const user = JSON.parse(localStorage.getItem('sessionUser') || 'null');\n  if (!user) {\n    alert('Please sign in to vote');\n    return;\n  }\n\n  try {\n    const res = await fetch(`/api/comments/${commentId}/vote`, {\n      method: 'POST',\n      headers: { 'Content-Type': 'application/json' },\n      body: JSON.stringify({ user_id: user.id, vote })\n    });\n    const data = await res.json();\n    if (!res.ok) throw new Error(data.error || 'Failed to vote');\n\n    // –ü–µ—Ä–µ–∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è –∫–æ–º–µ–Ω—Ç–∞—Ä—ñ–≤\n    await loadComments(postId, listEl);\n  } catch (err) {\n    console.error(err);\n    alert(err.message || 'Failed to vote');\n  }\n}"],"names":["showView","name","v","navItems","item","view","e","i","userNameSpan","sessionUser","userBlock","toggleBtn","menu","logoutBtn","tabs","tab","t","initial","relativeTime","iso","diff","sec","min","hrs","escapeHtml","str","loadPosts","list","post","createPostElement","err","article","upBtn","downBtn","diffEl","votePost","postId","vote","thisBtn","otherBtn","res","data","newDiff","old","form","loadMyPosts","card","homeContainer","postCard","commentsEl","listEl","formEl","loadComments","attachFormHandler","comments","tree","buildTree","renderTree","map","c","roots","nodes","container","nested","li","attachCommentHandlers","body","user","newComment","liEl","commentId","replyBtn","voteComment","replyForm","created"],"mappings":"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"}